<link rel="stylesheet" th:href="@{/css/auth/signup.css}">
<link rel="stylesheet" th:href="@{/css/basic.css}">
<script th:src="@{/js/validation.js}"></script>
<header th:replace="~{layout/main/header.html}"></header>
<main>
    <form action=""                                                                                                         >
        <div class="container">
            <h3 class="header-title">약관동의</h3>
            <div class="header-gubun"></div>
            <div class="box box1">
            <th:block th:each="t : ${terms}" th:if="${t.termsName.trim()!='위치정보 이용약관'}">
                <div class="title">
                    <span class="red">( 필수 )</span>
                    <span th:text="${t.termsName}"></span>
                </div>
                <!-- 이용약관 -->
                <textarea readonly class="content" th:text="${t.termsContent}"></textarea>
                <div class="essential-check check">
                    <label style="font-size: 16px; letter-spacing: -0.5px" for="place">
                        <input style="margin-top: 10px;" type="checkbox"> 동의하기
                    </label>
                </div>
            </th:block>
            <th:block th:each="t : ${terms}"
                      th:if="${t.termsName.trim() == '위치정보 이용약관' and t.termsType == 'customer'}">
                <div class="title">
                    <span class="blue">( 선택 )</span>
                    <span th:text="${t.termsName}"></span>
                </div>
                <!-- 이용약관 -->
                <textarea readonly class="content" th:text="${t.termsContent}"></textarea>
                <div class="not-required-check check">
                    <!-- 선택약관 동의여부  -->
                    <!-- 체크박스 선택 여부에 따라 true=1, false=0  -->
                    <label for="place">
                        <input type="checkbox" id="place" value="1" onclick="toggleCheckboxValue(event)"> 동의하기
                        <input type="hidden" id="placeHidden" name="custOptional">
                    </label>
                </div>
            </th:block>


            </div>
            <div class="signup">
                <button onclick="submitData()" type="button" disabled id="next-btn" class="btnSignUp next-btn">동의하기</button>
            </div>
        </div>
    </form>
</main>
<footer th:replace="~{layout/main/footer.html}"></footer>



    <script>
        const essentialCheckboxes = document.querySelectorAll('.essential-check input');
        const nextBtn = document.getElementById('next-btn');
        const page1 = document.querySelector('.container')
        const page2 = document.querySelector('.container2')

        function checkAllEssentialChecked() {
            const allChecked = Array.from(essentialCheckboxes).every((checkbox) => checkbox.checked);
            if (allChecked) {
                nextBtn.style.pointerEvents = 'auto';
                nextBtn.style.cursor = 'pointer';
                nextBtn.style.opacity = '1';
                nextBtn.disabled = false;
            } else {
                nextBtn.style.pointerEvents = 'none';
                nextBtn.style.opacity = '0.5';
                nextBtn.disabled = true;
            }
        }

        essentialCheckboxes.forEach((checkbox) => {
            checkbox.addEventListener('change', checkAllEssentialChecked);
        });

        function nextFunction(){
        }
        // 선택약관 동의 여부
        function toggleCheckboxValue(event) {
            const hiddenInput = document.getElementById('placeHidden')
            if (event.target.checked) {
                hiddenInput.value = "1";  // 체크되면 1
            } else {
                hiddenInput.value = "0";  // 체크 안되면 0
            }
        }

        function submitData(){
            const hiddenInput = document.getElementById('placeHidden')
            console.log(hiddenInput.value);  // hidden input의 값 확인
            let url = "/auth/customer/" + hiddenInput.value;
            window.location.href = url;
        }

        
    </script>
</body>
</html>